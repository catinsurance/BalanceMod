local a=Vector(0,0)local b=Game()local c={}local d={}local e=Vector(-19,-54)local f=Vector(-20,0)local g=101;local h=9;local i=6;local j=12;local k={Normal=0,Deleting=1,ChargedStart=2,ChargedAnimDone=3}c.DefaultSprite="gfx/chargebar.anm2"c.ChargeBarOffset=e;c.ChargeBarOverlapOffset=f;c.ChargeBarFrameCount=g;c.ChargeBarDeleteFrameCount=h;c.ChargeBarChargedFrameCount=i;c.ChargeBarStartChargedFrameCount=j;c.ChargeBarState=k;local function l(table)local m=0;for n in ipairs(table)do m=m+1 end;return m end;local function o(table)local m=0;for n in pairs(table)do m=m+1 end;return m end;local function p(q)local r=1;local s=q:GetPlayerType()if s==PlayerType.PLAYER_LAZARUS2_B then r=2 end;local t=q:GetCollectibleRNG(r):GetSeed()return tostring(t)end;local function u()local v=b:GetNumPlayers()local w={}for x=0,v do local q=Isaac.GetPlayer(x)table.insert(w,q)end;return w end;local function y(z,A,B)if z<A then return A elseif z>B then return B end;return z end;local function C(D)local E=2^52;if math.abs(D)>E then return D end;return D<0 and D-E+E or D+E-E end;function c:MakeCustomChargeBar(q,F,G,H,I)local J=p(q)if d[J]==nil then d[J]={}end;local K=o(d[J])+1;d[J][K]={Index=K,State=k.Normal,Sprite=F,Charge=G,MaxCharge=H,IncrementValue=I}return K end;function c:UpdateCustomBarState(q,L,M)local J=p(q)local N=d[J]if not N then return end;if N[L]==nil then return end;N[L].State=y(M,k.Normal,k.ChargedAnimDone)if M==k.Deleting then N[L].Sprite:Play("Disappear",true)elseif M==k.ChargedStart then N[L].Sprite:Play("StartCharged",true)elseif M==k.ChargedAnimDone then N[L].Sprite:Play("Charged",true)elseif M==k.Normal then N[L].Sprite:Play("Charging",true)end end;function c:GetCustomChargeBarCharge(q,L)local J=p(q)local N=d[J]if not N then return nil end;local O=N[L]if O==nil then return nil end;return O.Charge,O.MaxCharge,O.IncrementValue end;function c:UpdateCustomChargeBar(q,L)local J=p(q)if d[J]==nil then d[J]={}end;if d[J][L]==nil then return end;if d[J][L].State==k.Normal then d[J][L].Charge=y(d[J][L].Charge+d[J][L].IncrementValue,1,d[J][L].MaxCharge)end;local O=d[J][L]if O.State==k.Deleting then if O.Sprite:IsFinished("Disappear")then d[J][L]=nil;O=nil;return end end;local P=q:GetFlyingOffset()local Q=q.SpriteScale*e;local R=f*(O.Index-1)local S=q.Position+R+P+Q;if O.State==k.Normal then local T=g/O.MaxCharge;local U=y(C(O.Charge*T),1,g)O.Sprite:SetFrame("Charging",U)else if b:GetFrameCount()%2==0 then O.Sprite:Update()end end;local V=b:GetRoom():WorldToScreenPosition(S)O.Sprite:Render(V,a,a)end;function c:UpdateAllCustomChargeBars()for n,q in ipairs(u())do local J=p(q)local N=d[J]if N==nil then d[J]={}N={}end;for n,O in pairs(N)do c:UpdateCustomChargeBar(q,O.Index)end end end;function c:UpdateChargeBarsForPlayer(q)local J=p(q)local N=d[J]if N==nil then d[J]={}N={}end;for n,O in pairs(N)do c:UpdateCustomChargeBar(q,O.Index)end end;function c:DeleteCustomChargeBar(q,K)c:UpdateCustomBarState(q,K,k.Deleting)end;return c